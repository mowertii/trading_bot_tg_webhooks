# üìò Webhook Trader Bot ‚Äî –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å **—Å–∏–≥–Ω–∞–ª—ã –∏–∑ TradingView** –∫ **–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º** —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç–æ–º –ø—Ä—è–º–æ –∏–∑ **Telegram**.

---

## üñ• –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: Linux (Ubuntu 20.04+), macOS –∏–ª–∏ Windows 10/11 —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º [Docker Desktop](https://www.docker.com/products/docker-desktop).  
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç**: –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è —Å–≤—è–∑–∏ —Å API –¢–∏–Ω—å–∫–æ—Ñ—Ñ –∏ Telegram.  
- **Docker + docker-compose**: –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.  

---

## üîë –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏ ID

### 1. Telegram Bot Token (BOT_TOKEN)
1. –í Telegram –Ω–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ `@BotFather`.
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot` –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞.
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π **BOT_TOKEN**.

### 2. Telegram Chat ID (TG_CHAT_ID)
- –î–æ–±–∞–≤—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ –≤ —Å–≤–æ–π **–ª–∏—á–Ω—ã–π —á–∞—Ç** –∏–ª–∏ **–≥—Ä—É–ø–ø—É**.  
- –ù–∞–ø–∏—à–∏—Ç–µ –≤ —ç—Ç–æ—Ç —á–∞—Ç –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.  
- –í –±—Ä–∞—É–∑–µ—Ä–µ –æ—Ç–∫—Ä–æ–π—Ç–µ:  
  ```
  https://api.telegram.org/bot<BOT_TOKEN>/getUpdates
  ```
- –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏—Ç–µ –ø–æ–ª–µ `"chat":{"id": ... }` ‚Üí —ç—Ç–æ –≤–∞—à **TG_CHAT_ID**.  
  ‚ö†Ô∏è –ü–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è **–ª–∏—á–Ω—ã—Ö —á–∞—Ç–æ–≤**, —Ç–∞–∫ –∏ –¥–ª—è **–≥—Ä—É–ø–ø**.

### 3. –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
- –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ [–ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏](https://www.tinkoff.ru/invest/).  
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **¬´API –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏¬ª** ‚Üí —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ **TINKOFF_TOKEN**.  
- –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π **ACCOUNT_ID** (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±—Ä–æ–∫–µ—Ä—Å–∫–æ–≥–æ —Å—á—ë—Ç–∞).  

### 4. Webhook Secret
- –ü—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–π –Ω–∞–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–∞ [random.org](https://www.random.org/passwords/)) ‚Äî —ç—Ç–æ –±—É–¥–µ—Ç –≤–∞—à **WEBHOOK_SECRET**.  

---

## ‚öôÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone git@github.com:mowertii/trading_bot_tg_webhooks.git
   cd trading_bot_tg_webhooks
   ```

2. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª `.env` –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```ini
   TINKOFF_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
   ACCOUNT_ID=–≤–∞—à_—Å—á—ë—Ç
   BOT_TOKEN=–≤–∞—à_—Ç–≥_–±–æ—Ç_—Ç–æ–∫–µ–Ω
   TG_CHAT_ID=–≤–∞—à_chat_id
   WEBHOOK_SECRET=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç
   ```

3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:
   ```
   app/
     ‚îú‚îÄ‚îÄ bot/
     ‚îú‚îÄ‚îÄ trading/
     ‚îú‚îÄ‚îÄ webhook_server.py
   db/
     ‚îî‚îÄ‚îÄ bot_settings.json
   docker-compose.yml
   Dockerfile
   ```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. –ü–æ–¥–Ω–∏–º–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
   ```bash
   docker-compose up --build -d
   ```

2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   curl http://localhost:8080/health
   ```
   –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
   ```json
   {"status":"healthy","service":"trading-webhook-bot"}
   ```

3. –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram-–±–æ—Ç–∞:  
   –í —á–∞—Ç –ø–∏—à–µ–º:
   ```
   /show_settings
   ```
   –±–æ—Ç –≤–µ—Ä–Ω—ë—Ç —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ä–∏—Å–∫, —Å—Ç–æ–ø, —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç).

---

## üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ TradingView

1. –í TradingView —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∞–ª–µ—Ä—Ç.  
2. –í –ø–æ–ª–µ **Webhook URL** —É–∫–∞–∑—ã–≤–∞–µ–º:
   ```
   https://–≤–∞—à_–¥–æ–º–µ–Ω/webhook
   ```
3. –í **Headers** –¥–æ–±–∞–≤–ª—è–µ–º:
   ```
   X-Signature-256: sha256=<—Å–∏–≥–Ω–∞—Ç—É—Ä–∞, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞—à–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º>
   ```
4. –í **Message** –ø–∏—à–µ–º JSON.  
   –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–∫—É–ø–∫–∏:
   ```json
   {
     "action": "buy",
     "symbol": "SBER"
   }
   ```
   –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏:
   ```json
   {
     "action": "sell",
     "symbol": "SBER"
   }
   ```

---

## ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ Telegram

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```
/set_risk 0.5     ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É (50%)
/set_stop 1%      ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å (1%)
/set_tp 9%        ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç (9%)
/show_settings    ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
/help             ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

- **–ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≥—Ä—É–ø–ø–∞—Ö Telegram?**  
  ‚úÖ –î–∞, –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤ –ª–∏—á–Ω—ã—Ö —á–∞—Ç–∞—Ö, —Ç–∞–∫ –∏ –≤ –≥—Ä—É–ø–ø–∞—Ö.

- **–ß—Ç–æ –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–ø–∞–¥—ë—Ç?**  
  Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `db/bot_settings.json`.

- **–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ä–∏—Å–∫–∏ –∏ —Å—Ç–æ–ø—ã?**  
  –í JSON-—Ñ–∞–π–ª–µ `db/bot_settings.json`. –ò—Ö –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø—Ä—è–º–æ –∏–∑ Telegram.

---
